# CF Office Hours Platform - Fullstack Architecture Document

## Table of Contents

- [CF Office Hours Platform - Fullstack Architecture Document](#table-of-contents)
  - [Table of Contents](./table-of-contents.md)
  - [1. Introduction](./1-introduction.md)
    - [1.1 Starter Template or Existing Project](./1-introduction.md#11-starter-template-or-existing-project)
    - [1.2 Change Log](./1-introduction.md#12-change-log)
  - [2. High Level Architecture](./2-high-level-architecture.md)
    - [2.1 Technical Summary](./2-high-level-architecture.md#21-technical-summary)
    - [2.2 Platform and Infrastructure Choice](./2-high-level-architecture.md#22-platform-and-infrastructure-choice)
    - [2.3 Repository Structure](./2-high-level-architecture.md#23-repository-structure)
    - [2.4 High Level Architecture Diagram](./2-high-level-architecture.md#24-high-level-architecture-diagram)
    - [2.5 Architectural Patterns](./2-high-level-architecture.md#25-architectural-patterns)
  - [3. Tech Stack](./3-tech-stack.md)
    - [3.1 Technology Stack Table](./3-tech-stack.md#31-technology-stack-table)
    - [3.2 Cloudflare Compatibility Date](./3-tech-stack.md#32-cloudflare-compatibility-date)
    - [3.3 Email Notification Strategy](./3-tech-stack.md#33-email-notification-strategy)
  - [4. Data Models](./4-data-models.md)
    - [4.1 User & Profile Models](./4-data-models.md#41-user-profile-models)
    - [4.2 Tag & Taxonomy Models](./4-data-models.md#42-tag-taxonomy-models)
    - [4.3 Availability & Booking Models](./4-data-models.md#43-availability-booking-models)
    - [4.4 Reputation & Rating Models](./4-data-models.md#44-reputation-rating-models)
    - [4.5 Calendar Integration Models](./4-data-models.md#45-calendar-integration-models)
    - [4.6 Notification & Audit Models](./4-data-models.md#46-notification-audit-models)
    - [4.7 Edge Case Handling](./4-data-models.md#47-edge-case-handling)
  - [5. API Specification](./5-api-specification.md)
    - [5.1 API Design Philosophy](./5-api-specification.md#51-api-design-philosophy)
    - [5.2 API Base Structure](./5-api-specification.md#52-api-base-structure)
    - [5.3 Core API Schemas (Zod)](./5-api-specification.md#53-core-api-schemas-zod)
    - [5.4 REST API Endpoints (Grouped by Resource)](./5-api-specification.md#54-rest-api-endpoints-grouped-by-resource)
      - [1. Authentication & User Management](./5-api-specification.md#1-authentication-user-management)
      - [2. Calendar Integration](./5-api-specification.md#2-calendar-integration)
      - [3. Availability Management](./5-api-specification.md#3-availability-management)
      - [4. Bookings](./5-api-specification.md#4-bookings)
      - [5. Ratings & Reputation](./5-api-specification.md#5-ratings-reputation)
      - [6. Mentor-Specific Exception Requests](./5-api-specification.md#6-mentor-specific-exception-requests)
      - [7. Tags & Taxonomy](./5-api-specification.md#7-tags-taxonomy)
      - [8. Matching & Recommendations](./5-api-specification.md#8-matching-recommendations)
      - [9. Admin/Coordinator](./5-api-specification.md#9-admincoordinator)
      - [10. Webhooks (Airtable Integration)](./5-api-specification.md#10-webhooks-airtable-integration)
    - [5.5 Error Response Format](./5-api-specification.md#55-error-response-format)
    - [5.6 OpenAPI Type Generation](./5-api-specification.md#56-openapi-type-generation)
    - [5.7 API Sample Payloads](./5-api-specification.md#57-api-sample-payloads)
      - [Top 10 Critical Endpoints](./5-api-specification.md#top-10-critical-endpoints)
      - [1. POST /auth/magic-link - Magic Link Authentication](./5-api-specification.md#1-post-authmagic-link-magic-link-authentication)
      - [2. POST /auth/oauth/google - OAuth Authentication (Google)](./5-api-specification.md#2-post-authoauthgoogle-oauth-authentication-google)
      - [3. POST /bookings - Create Booking](./5-api-specification.md#3-post-bookings-create-booking)
      - [4. GET /bookings - List Bookings](./5-api-specification.md#4-get-bookings-list-bookings)
      - [5. DELETE /bookings/:id - Cancel Booking](./5-api-specification.md#5-delete-bookingsid-cancel-booking)
      - [6. POST /availability - Create Availability](./5-api-specification.md#6-post-availability-create-availability)
      - [7. GET /availability/slots - Browse Available Slots](./5-api-specification.md#7-get-availabilityslots-browse-available-slots)
      - [8. GET /users/:id/profile - Get User Profile](./5-api-specification.md#8-get-usersidprofile-get-user-profile)
      - [9. POST /matching/find-mentors - Find Matching Mentors](./5-api-specification.md#9-post-matchingfind-mentors-find-matching-mentors)
      - [10. POST /tier-overrides - Request Tier Override](./5-api-specification.md#10-post-tier-overrides-request-tier-override)
  - [6. Components](./6-components.md)
    - [6.1 Component Library Strategy](./6-components.md#61-component-library-strategy)
    - [6.2 Shadcn/ui Components Used](./6-components.md#62-shadcnui-components-used)
    - [6.3 Shared Common Components](./6-components.md#63-shared-common-components)
      - [6.3.1 UserAvatar Component](./6-components.md#631-useravatar-component)
      - [6.3.2 ReputationBadge Component](./6-components.md#632-reputationbadge-component)
      - [6.3.3 TagsList Component](./6-components.md#633-tagslist-component)
      - [6.3.4 EmptyState Component](./6-components.md#634-emptystate-component)
      - [6.3.5 LoadingSpinner Component](./6-components.md#635-loadingspinner-component)
      - [6.3.6 ErrorMessage Component](./6-components.md#636-errormessage-component)
    - [6.4 Feature-Specific Components](./6-components.md#64-feature-specific-components)
      - [6.4.1 User Discovery Components](./6-components.md#641-user-discovery-components)
      - [6.4.2 Booking Components](./6-components.md#642-booking-components)
      - [6.4.3 Profile Components](./6-components.md#643-profile-components)
      - [6.4.4 Availability Management Components (Mentor-only)](./6-components.md#644-availability-management-components-mentor-only)
      - [6.4.5 Coordinator Components](./6-components.md#645-coordinator-components)
    - [6.5 Layout Components](./6-components.md#65-layout-components)
    - [6.6 Component Design Patterns](./6-components.md#66-component-design-patterns)
      - [6.6.1 Composition Over Props Drilling](./6-components.md#661-composition-over-props-drilling)
      - [6.6.2 Controlled vs Uncontrolled Components](./6-components.md#662-controlled-vs-uncontrolled-components)
      - [6.6.3 Render Props for Flexible UI](./6-components.md#663-render-props-for-flexible-ui)
      - [6.6.4 Compound Components for Complex UI](./6-components.md#664-compound-components-for-complex-ui)
      - [6.6.5 Error Boundaries for Graceful Failures](./6-components.md#665-error-boundaries-for-graceful-failures)
    - [6.7 Component Testing Approach](./6-components.md#67-component-testing-approach)
    - [6.8 Accessibility (WCAG 2.1 AA Compliance)](./6-components.md#68-accessibility-wcag-21-aa-compliance)
    - [6.9 Performance Optimization](./6-components.md#69-performance-optimization)
    - [6.10 Component Documentation Standards](./6-components.md#610-component-documentation-standards)
  - [7. Frontend Architecture](./7-frontend-architecture.md)
    - [7.1 Frontend Application Structure](./7-frontend-architecture.md#71-frontend-application-structure)
    - [7.2 Routing Strategy](./7-frontend-architecture.md#72-routing-strategy)
    - [7.3 State Management](./7-frontend-architecture.md#73-state-management)
      - [7.3.1 Zustand for UI State](./7-frontend-architecture.md#731-zustand-for-ui-state)
      - [7.3.2 React Query for Server State](./7-frontend-architecture.md#732-react-query-for-server-state)
    - [7.4 Data Fetching & API Client](./7-frontend-architecture.md#74-data-fetching-api-client)
    - [7.5 Authentication Flow](./7-frontend-architecture.md#75-authentication-flow)
    - [7.6 Real-Time Updates (Supabase Realtime)](./7-frontend-architecture.md#76-real-time-updates-supabase-realtime)
    - [7.7 Form Handling](./7-frontend-architecture.md#77-form-handling)
    - [7.8 Calendar Integration (Frontend)](./7-frontend-architecture.md#78-calendar-integration-frontend)
    - [7.9 Error Handling & Loading States](./7-frontend-architecture.md#79-error-handling-loading-states)
    - [7.10 Performance Optimization Strategies](./7-frontend-architecture.md#710-performance-optimization-strategies)
    - [7.11 Environment Configuration](./7-frontend-architecture.md#711-environment-configuration)
    - [7.12 Build Configuration](./7-frontend-architecture.md#712-build-configuration)
    - [7.13 Testing Strategy (Frontend)](./7-frontend-architecture.md#713-testing-strategy-frontend)
    - [7.14 Frontend Security Considerations](./7-frontend-architecture.md#714-frontend-security-considerations)
  - [8. Backend Architecture](./8-backend-architecture.md)
    - [8.1 Backend Application Structure](./8-backend-architecture.md#81-backend-application-structure)
    - [8.2 Entry Point & App Initialization](./8-backend-architecture.md#82-entry-point-app-initialization)
    - [8.3 Routing Layer (Hono Routes)](./8-backend-architecture.md#83-routing-layer-hono-routes)
    - [8.4 Middleware Layer](./8-backend-architecture.md#84-middleware-layer)
    - [8.5 Service Layer (Business Logic)](./8-backend-architecture.md#85-service-layer-business-logic)
    - [8.6 Repository Layer (Data Access)](./8-backend-architecture.md#86-repository-layer-data-access)
    - [8.7 Reputation Calculator Service](./8-backend-architecture.md#87-reputation-calculator-service)
      - [8.7.1 Reputation Utility Functions](./8-backend-architecture.md#871-reputation-utility-functions)
      - [8.7.2 Reputation Service Implementation](./8-backend-architecture.md#872-reputation-service-implementation)
    - [8.8 Provider Interfaces (External Integrations)](./8-backend-architecture.md#88-provider-interfaces-external-integrations)
    - [8.8 Background Jobs (Durable Objects)](./8-backend-architecture.md#88-background-jobs-durable-objects)
    - [8.9 Webhook Handling (Airtable Sync)](./8-backend-architecture.md#89-webhook-handling-airtable-sync)
    - [8.10 Error Handling & Custom Errors](./8-backend-architecture.md#810-error-handling-custom-errors)
    - [8.11 Utility Functions](./8-backend-architecture.md#811-utility-functions)
    - [8.12 Backend Testing Strategy](./8-backend-architecture.md#812-backend-testing-strategy)
    - [8.13 Performance Considerations](./8-backend-architecture.md#813-performance-considerations)
    - [8.14 Security Best Practices](./8-backend-architecture.md#814-security-best-practices)
    - [8.15 Deployment Configuration](./8-backend-architecture.md#815-deployment-configuration)
  - [9. Unified Project Structure](./9-unified-project-structure.md)
    - [9.1 Complete Monorepo Structure](./9-unified-project-structure.md#91-complete-monorepo-structure)
    - [9.2 Root Package Configuration](./9-unified-project-structure.md#92-root-package-configuration)
    - [9.3 Workspace Package Configuration](./9-unified-project-structure.md#93-workspace-package-configuration)
    - [9.4 TypeScript Configuration](./9-unified-project-structure.md#94-typescript-configuration)
    - [9.5 ESLint Configuration](./9-unified-project-structure.md#95-eslint-configuration)
    - [9.6 Build Pipeline & Scripts](./9-unified-project-structure.md#96-build-pipeline-scripts)
    - [9.7 Development Workflow Commands](./9-unified-project-structure.md#97-development-workflow-commands)
    - [9.8 Environment Variables](./9-unified-project-structure.md#98-environment-variables)
    - [9.9 VS Code Configuration](./9-unified-project-structure.md#99-vs-code-configuration)
    - [9.10 Git Configuration](./9-unified-project-structure.md#910-git-configuration)
    - [9.11 Dependency Management Best Practices](./9-unified-project-structure.md#911-dependency-management-best-practices)
    - [9.12 Build Optimization](./9-unified-project-structure.md#912-build-optimization)
    - [9.13 Continuous Integration](./9-unified-project-structure.md#913-continuous-integration)
  - [10. Development Workflow](./10-development-workflow.md)
    - [10.1 Initial Development Setup](./10-development-workflow.md#101-initial-development-setup)
      - [10.1.0 Repository Initialization (First-Time Setup Only)](./10-development-workflow.md#1010-repository-initialization-first-time-setup-only)
      - [10.1.1 Regular Developer Setup](./10-development-workflow.md#1011-regular-developer-setup)
      - [10.1.6 Database Migrations](./10-development-workflow.md#1016-database-migrations)
    - [10.2 Local Development](./10-development-workflow.md#102-local-development)
    - [10.3 Testing Practices](./10-development-workflow.md#103-testing-practices)
    - [10.4 Debugging Strategies](./10-development-workflow.md#104-debugging-strategies)
    - [10.5 Code Quality & Standards](./10-development-workflow.md#105-code-quality-standards)
    - [10.6 Git Workflow](./10-development-workflow.md#106-git-workflow)
    - [10.7 Pull Request Process](./10-development-workflow.md#107-pull-request-process)
    - [10.8 Troubleshooting Common Issues](./10-development-workflow.md#108-troubleshooting-common-issues)
    - [10.9 Performance Profiling](./10-development-workflow.md#109-performance-profiling)
    - [10.10 Documentation Practices](./10-development-workflow.md#1010-documentation-practices)
    - [10.11 Collaboration Best Practices](./10-development-workflow.md#1011-collaboration-best-practices)
  - [11. Deployment Architecture](./11-deployment-architecture.md)
    - [11.1 Deployment Overview](./11-deployment-architecture.md#111-deployment-overview)
    - [11.2 Environment Strategy](./11-deployment-architecture.md#112-environment-strategy)
    - [11.3 Frontend Deployment (Cloudflare Pages)](./11-deployment-architecture.md#113-frontend-deployment-cloudflare-pages)
    - [11.4 Backend Deployment (Cloudflare Workers)](./11-deployment-architecture.md#114-backend-deployment-cloudflare-workers)
    - [11.5 Database Deployment (Supabase)](./11-deployment-architecture.md#115-database-deployment-supabase)
    - [11.6 CI/CD Pipeline](./11-deployment-architecture.md#116-cicd-pipeline)
    - [11.7 Monitoring & Health Checks](./11-deployment-architecture.md#117-monitoring-health-checks)
    - [11.8 Rollback Procedures](./11-deployment-architecture.md#118-rollback-procedures)
    - [11.10 Performance Optimization](./11-deployment-architecture.md#1110-performance-optimization)
    - [11.11 Security Hardening](./11-deployment-architecture.md#1111-security-hardening)
    - [11.12 Cost Management](./11-deployment-architecture.md#1112-cost-management)
    - [11.13 Deployment Checklist](./11-deployment-architecture.md#1113-deployment-checklist)
  - [12. Security and Performance](./12-security-and-performance.md)
    - [12.1 Security Architecture Overview](./12-security-and-performance.md#121-security-architecture-overview)
    - [12.2 Authentication & Authorization](./12-security-and-performance.md#122-authentication-authorization)
    - [12.3 Data Protection](./12-security-and-performance.md#123-data-protection)
    - [12.4 API Security](./12-security-and-performance.md#124-api-security)
    - [12.5 Frontend Security](./12-security-and-performance.md#125-frontend-security)
    - [12.6 Performance Optimization](./12-security-and-performance.md#126-performance-optimization)
    - [12.7 Performance Monitoring](./12-security-and-performance.md#127-performance-monitoring)
    - [12.8 Security Checklist](./12-security-and-performance.md#128-security-checklist)
  - [13. Testing Strategy](./13-testing-strategy.md)
    - [13.1 Testing Philosophy](./13-testing-strategy.md#131-testing-philosophy)
    - [13.2 Unit Testing (Vitest)](./13-testing-strategy.md#132-unit-testing-vitest)
    - [13.3 Integration Testing](./13-testing-strategy.md#133-integration-testing)
    - [13.4 End-to-End Testing (Playwright)](./13-testing-strategy.md#134-end-to-end-testing-playwright)
    - [13.5 Chrome DevTools MCP (Alternative/Complement to Playwright)](./13-testing-strategy.md#135-chrome-devtools-mcp-alternativecomplement-to-playwright)
    - [13.6 API Contract Testing](./13-testing-strategy.md#136-api-contract-testing)
    - [13.7 Test Utilities](./13-testing-strategy.md#137-test-utilities)
    - [13.8 Testing Best Practices](./13-testing-strategy.md#138-testing-best-practices)
    - [13.9 CI/CD Integration](./13-testing-strategy.md#139-cicd-integration)
    - [13.10 Test Coverage Goals](./13-testing-strategy.md#1310-test-coverage-goals)
    - [13.11 Test Coverage by Epic](./13-testing-strategy.md#1311-test-coverage-by-epic)
  - [14. Coding Standards](./14-coding-standards.md)
    - [14.1 General Principles](./14-coding-standards.md#141-general-principles)
    - [14.2 TypeScript Standards](./14-coding-standards.md#142-typescript-standards)
    - [14.3 File Size & Atomicity](./14-coding-standards.md#143-file-size-atomicity)
    - [14.4 File Organization & Naming](./14-coding-standards.md#144-file-organization-naming)
    - [14.5 Import Order & Organization](./14-coding-standards.md#145-import-order-organization)
    - [14.6 Naming Conventions](./14-coding-standards.md#146-naming-conventions)
    - [14.7 Function Standards](./14-coding-standards.md#147-function-standards)
    - [14.8 React Component Standards](./14-coding-standards.md#148-react-component-standards)
    - [14.9 Documentation Standards](./14-coding-standards.md#149-documentation-standards)
    - [14.10 Error Handling Standards](./14-coding-standards.md#1410-error-handling-standards)
    - [14.11 Testing Standards](./14-coding-standards.md#1411-testing-standards)
    - [14.12 Performance Best Practices](./14-coding-standards.md#1412-performance-best-practices)
    - [14.13 Security Best Practices](./14-coding-standards.md#1413-security-best-practices)
    - [14.14 Accessibility Standards](./14-coding-standards.md#1414-accessibility-standards)
    - [14.15 Git Commit Standards](./14-coding-standards.md#1415-git-commit-standards)
    - [14.16 Code Review Checklist](./14-coding-standards.md#1416-code-review-checklist)
  - [15. Error Handling Strategy](./15-error-handling-strategy.md)
    - [15.1 Error Handling Philosophy](./15-error-handling-strategy.md#151-error-handling-philosophy)
    - [15.2 Frontend Error Handling](./15-error-handling-strategy.md#152-frontend-error-handling)
      - [15.2.1 Error Boundary Strategy](./15-error-handling-strategy.md#1521-error-boundary-strategy)
      - [15.2.2 API Client Error Handling](./15-error-handling-strategy.md#1522-api-client-error-handling)
      - [15.2.3 Error Message Dictionary](./15-error-handling-strategy.md#1523-error-message-dictionary)
    - [15.3 Backend Error Handling](./15-error-handling-strategy.md#153-backend-error-handling)
      - [15.3.1 Custom Error Classes](./15-error-handling-strategy.md#1531-custom-error-classes)
      - [15.3.2 Error Handler Middleware](./15-error-handling-strategy.md#1532-error-handler-middleware)
      - [15.3.3 Error Usage in Routes](./15-error-handling-strategy.md#1533-error-usage-in-routes)
    - [15.4 Logging Strategy](./15-error-handling-strategy.md#154-logging-strategy)
      - [15.4.1 Logger Implementation](./15-error-handling-strategy.md#1541-logger-implementation)
      - [15.4.2 Logging Best Practices](./15-error-handling-strategy.md#1542-logging-best-practices)
    - [15.5 Async Error Handling](./15-error-handling-strategy.md#155-async-error-handling)
    - [15.6 Form Validation Error Handling](./15-error-handling-strategy.md#156-form-validation-error-handling)
    - [15.7 External Service Error Handling](./15-error-handling-strategy.md#157-external-service-error-handling)
    - [15.8 Error Recovery Patterns](./15-error-handling-strategy.md#158-error-recovery-patterns)
  - [16. Monitoring and Observability](./16-monitoring-and-observability.md)
    - [16.1 Observability Philosophy](./16-monitoring-and-observability.md#161-observability-philosophy)
    - [16.2 Health Checks](./16-monitoring-and-observability.md#162-health-checks)
      - [16.2.1 API Health Endpoint](./16-monitoring-and-observability.md#1621-api-health-endpoint)
    - [16.3 Built-In Monitoring Tools](./16-monitoring-and-observability.md#163-built-in-monitoring-tools)
      - [16.3.1 Cloudflare Workers Dashboard (Free)](./16-monitoring-and-observability.md#1631-cloudflare-workers-dashboard-free)
      - [16.3.2 Cloudflare Pages Dashboard (Free)](./16-monitoring-and-observability.md#1632-cloudflare-pages-dashboard-free)
      - [16.3.3 Supabase Dashboard (Free)](./16-monitoring-and-observability.md#1633-supabase-dashboard-free)
    - [16.4 Telemetry Interfaces (Stubs)](./16-monitoring-and-observability.md#164-telemetry-interfaces-stubs)
      - [16.4.1 ITelemetryProvider Interface](./16-monitoring-and-observability.md#1641-itelemetryprovider-interface)
      - [16.4.2 No-Op Implementation (MVP)](./16-monitoring-and-observability.md#1642-no-op-implementation-mvp)
      - [16.4.3 OpenTelemetry Stub (Future Implementation)](./16-monitoring-and-observability.md#1643-opentelemetry-stub-future-implementation)
    - [16.5 Instrumentation Points (Documented)](./16-monitoring-and-observability.md#165-instrumentation-points-documented)
      - [16.5.1 Backend Instrumentation](./16-monitoring-and-observability.md#1651-backend-instrumentation)
      - [16.5.2 Frontend Instrumentation](./16-monitoring-and-observability.md#1652-frontend-instrumentation)
    - [16.6 Alerting Strategy (Future)](./16-monitoring-and-observability.md#166-alerting-strategy-future)
    - [16.7 Dashboard Requirements (Future)](./16-monitoring-and-observability.md#167-dashboard-requirements-future)
    - [16.8 Logging Retention Policy](./16-monitoring-and-observability.md#168-logging-retention-policy)
    - [16.9 Observability Roadmap](./16-monitoring-and-observability.md#169-observability-roadmap)
    - [16.10 Developer Debugging Tools](./16-monitoring-and-observability.md#1610-developer-debugging-tools)
    - [16.11 Monitoring Checklist](./16-monitoring-and-observability.md#1611-monitoring-checklist)
  - [Document Complete](./document-complete.md)
