# CF Office Hours Platform - Fullstack Architecture Document

## Table of Contents

- [CF Office Hours Platform - Fullstack Architecture Document](#table-of-contents)
  - [Table of Contents](./table-of-contents.md)
  - [1. Introduction](./1-introduction.md)
    - [1.1 Starter Template or Existing Project](./1-introduction.md#11-starter-template-or-existing-project)
    - [1.2 Change Log](./1-introduction.md#12-change-log)
  - [2. High Level Architecture](./2-high-level-architecture.md)
    - [2.1 Technical Summary](./2-high-level-architecture.md#21-technical-summary)
    - [2.2 Platform and Infrastructure Choice](./2-high-level-architecture.md#22-platform-and-infrastructure-choice)
    - [2.3 Repository Structure](./2-high-level-architecture.md#23-repository-structure)
    - [2.4 High Level Architecture Diagram](./2-high-level-architecture.md#24-high-level-architecture-diagram)
    - [2.5 Architectural Patterns](./2-high-level-architecture.md#25-architectural-patterns)
  - [3. Tech Stack](./3-tech-stack.md)
    - [3.1 Technology Stack Table](./3-tech-stack.md#31-technology-stack-table)
    - [3.2 Cloudflare Compatibility Date](./3-tech-stack.md#32-cloudflare-compatibility-date)
    - [3.3 Email Notification Strategy](./3-tech-stack.md#33-email-notification-strategy)
  - [4. Data Models](./4-data-models.md)
    - [4.1 User & Profile Models](./4-data-models.md#41-user-profile-models)
    - [4.2 Portfolio Company & URL Models](./4-data-models.md#42-portfolio-company-url-models)
    - [4.3 Tag & Taxonomy Models](./4-data-models.md#43-tag-taxonomy-models)
    - [4.4 Availability & Booking Models](./4-data-models.md#44-availability-booking-models)
    - [4.5 Reputation & Rating Models](./4-data-models.md#45-reputation-rating-models)
    - [4.6 Calendar Integration Models](./4-data-models.md#46-calendar-integration-models)
    - [4.7 Notification & Audit Models](./4-data-models.md#47-notification-audit-models)
    - [4.8 Sample Data & Seed Scripts](./4-data-models.md#48-sample-data-seed-scripts)
      - [4.8.1 Taxonomy Sample Data](./4-data-models.md#481-taxonomy-sample-data)
      - [4.8.2 User/Mentor Sample Data](./4-data-models.md#482-usermentor-sample-data)
      - [4.8.3 Portfolio Company Sample Data](./4-data-models.md#483-portfolio-company-sample-data)
      - [4.8.4 Production-Safe Seed Data](./4-data-models.md#484-production-safe-seed-data)
      - [4.8.5 Seed Script Organization](./4-data-models.md#485-seed-script-organization)
      - [4.8.6 Execution Strategy](./4-data-models.md#486-execution-strategy)
      - [4.8.7 Development Workflow](./4-data-models.md#487-development-workflow)
    - [4.9 Edge Case Handling](./4-data-models.md#49-edge-case-handling)
    - [4.10 External System Integration](./4-data-models.md#410-external-system-integration)
      - [4.10.1 Airtable as Source of Truth](./4-data-models.md#4101-airtable-as-source-of-truth)
      - [4.10.2 Airtable Data Schema](./4-data-models.md#4102-airtable-data-schema)
      - [4.10.3 Field Mapping Table](./4-data-models.md#4103-field-mapping-table)
      - [4.10.4 Webhook Configuration](./4-data-models.md#4104-webhook-configuration)
      - [4.10.5 Webhook Processing Flow](./4-data-models.md#4105-webhook-processing-flow)
      - [4.10.6 Error Handling & Retry Strategy](./4-data-models.md#4106-error-handling-retry-strategy)
      - [4.10.7 Development vs Production Sync](./4-data-models.md#4107-development-vs-production-sync)
      - [4.10.8 Sync Dependency Graph](./4-data-models.md#4108-sync-dependency-graph)
  - [5. API Specification](./5-api-specification.md)
    - [5.1 API Design Philosophy](./5-api-specification.md#51-api-design-philosophy)
    - [5.2 API Base Structure](./5-api-specification.md#52-api-base-structure)
    - [5.3 Core API Schemas (Zod)](./5-api-specification.md#53-core-api-schemas-zod)
    - [5.4 REST API Endpoints (Grouped by Resource)](./5-api-specification.md#54-rest-api-endpoints-grouped-by-resource)
      - [1. Authentication & User Management](./5-api-specification.md#1-authentication-user-management)
      - [2. Calendar Integration](./5-api-specification.md#2-calendar-integration)
      - [3. Availability Management](./5-api-specification.md#3-availability-management)
      - [4. Bookings](./5-api-specification.md#4-bookings)
      - [5. Ratings & Reputation](./5-api-specification.md#5-ratings-reputation)
      - [6. Mentor-Specific Exception Requests](./5-api-specification.md#6-mentor-specific-exception-requests)
      - [7. Tags & Taxonomy](./5-api-specification.md#7-tags-taxonomy)
      - [8. Matching & Recommendations](./5-api-specification.md#8-matching-recommendations)
      - [9. Admin/Coordinator](./5-api-specification.md#9-admincoordinator)
      - [10. Webhooks (Airtable Integration)](./5-api-specification.md#10-webhooks-airtable-integration)
    - [5.5 Error Response Format](./5-api-specification.md#55-error-response-format)
    - [5.6 OpenAPI Type Generation](./5-api-specification.md#56-openapi-type-generation)
    - [5.7 API Sample Payloads](./5-api-specification.md#57-api-sample-payloads)
      - [Top 10 Critical Endpoints](./5-api-specification.md#top-10-critical-endpoints)
      - [1. POST /auth/magic-link - Magic Link Authentication](./5-api-specification.md#1-post-authmagic-link-magic-link-authentication)
      - [2. POST /auth/oauth/google - OAuth Authentication (Google)](./5-api-specification.md#2-post-authoauthgoogle-oauth-authentication-google)
      - [3. POST /bookings - Create Booking](./5-api-specification.md#3-post-bookings-create-booking)
      - [4. GET /bookings - List Bookings](./5-api-specification.md#4-get-bookings-list-bookings)
      - [5. DELETE /bookings/:id - Cancel Booking](./5-api-specification.md#5-delete-bookingsid-cancel-booking)
      - [6. POST /availability - Create Availability](./5-api-specification.md#6-post-availability-create-availability)
      - [7. GET /availability/slots - Browse Available Slots](./5-api-specification.md#7-get-availabilityslots-browse-available-slots)
      - [8. GET /users/:id/profile - Get User Profile](./5-api-specification.md#8-get-usersidprofile-get-user-profile)
      - [9. POST /matching/find-mentors - Find Matching Mentors](./5-api-specification.md#9-post-matchingfind-mentors-find-matching-mentors)
      - [10. POST /tier-overrides - Request Tier Override](./5-api-specification.md#10-post-tier-overrides-request-tier-override)
  - [6. Components](./6-components.md)
    - [6.1 Component Library Strategy](./6-components.md#61-component-library-strategy)
    - [6.2 Shadcn/ui Components Used](./6-components.md#62-shadcnui-components-used)
    - [6.3 Shared Common Components](./6-components.md#63-shared-common-components)
      - [6.3.1 UserAvatar Component](./6-components.md#631-useravatar-component)
      - [6.3.2 ReputationBadge Component](./6-components.md#632-reputationbadge-component)
      - [6.3.3 TagsList Component](./6-components.md#633-tagslist-component)
      - [6.3.4 EmptyState Component](./6-components.md#634-emptystate-component)
      - [6.3.5 LoadingSpinner Component](./6-components.md#635-loadingspinner-component)
      - [6.3.6 ErrorMessage Component](./6-components.md#636-errormessage-component)
    - [6.4 Feature-Specific Components](./6-components.md#64-feature-specific-components)
      - [6.4.1 User Discovery Components](./6-components.md#641-user-discovery-components)
      - [6.4.2 Booking Components](./6-components.md#642-booking-components)
      - [6.4.3 Profile Components](./6-components.md#643-profile-components)
      - [6.4.4 Availability Management Components (Mentor-only)](./6-components.md#644-availability-management-components-mentor-only)
      - [6.4.5 Coordinator Components](./6-components.md#645-coordinator-components)
    - [6.5 Layout Components](./6-components.md#65-layout-components)
    - [6.6 Component Design Patterns](./6-components.md#66-component-design-patterns)
      - [6.6.1 Composition Over Props Drilling](./6-components.md#661-composition-over-props-drilling)
      - [6.6.2 Controlled vs Uncontrolled Components](./6-components.md#662-controlled-vs-uncontrolled-components)
      - [6.6.3 Render Props for Flexible UI](./6-components.md#663-render-props-for-flexible-ui)
      - [6.6.4 Compound Components for Complex UI](./6-components.md#664-compound-components-for-complex-ui)
      - [6.6.5 Error Boundaries for Graceful Failures](./6-components.md#665-error-boundaries-for-graceful-failures)
    - [6.7 Component Testing Approach](./6-components.md#67-component-testing-approach)
    - [6.8 Accessibility (WCAG 2.1 AA Compliance)](./6-components.md#68-accessibility-wcag-21-aa-compliance)
    - [6.9 Performance Optimization](./6-components.md#69-performance-optimization)
    - [6.10 Component Documentation Standards](./6-components.md#610-component-documentation-standards)
  - [7. Frontend Architecture](./7-frontend-architecture.md)
    - [7.1 Frontend Application Structure](./7-frontend-architecture.md#71-frontend-application-structure)
    - [7.2 Routing Strategy](./7-frontend-architecture.md#72-routing-strategy)
    - [7.3 State Management](./7-frontend-architecture.md#73-state-management)
      - [7.3.1 Zustand for UI State](./7-frontend-architecture.md#731-zustand-for-ui-state)
      - [7.3.2 React Query for Server State](./7-frontend-architecture.md#732-react-query-for-server-state)
    - [7.4 Data Fetching & API Client](./7-frontend-architecture.md#74-data-fetching-api-client)
    - [7.5 Authentication Flow](./7-frontend-architecture.md#75-authentication-flow)
    - [7.6 Real-Time Updates (Supabase Realtime)](./7-frontend-architecture.md#76-real-time-updates-supabase-realtime)
    - [7.7 Form Handling](./7-frontend-architecture.md#77-form-handling)
    - [7.8 Calendar Integration (Frontend)](./7-frontend-architecture.md#78-calendar-integration-frontend)
    - [7.9 Error Handling & Loading States](./7-frontend-architecture.md#79-error-handling-loading-states)
    - [7.10 Performance Optimization Strategies](./7-frontend-architecture.md#710-performance-optimization-strategies)
    - [7.11 Environment Configuration](./7-frontend-architecture.md#711-environment-configuration)
    - [7.12 Build Configuration](./7-frontend-architecture.md#712-build-configuration)
    - [7.13 Testing Strategy (Frontend)](./7-frontend-architecture.md#713-testing-strategy-frontend)
    - [7.14 Frontend Security Considerations](./7-frontend-architecture.md#714-frontend-security-considerations)
  - [8. Backend Architecture](./8-backend-architecture.md)
    - [8.1 Backend Application Structure](./8-backend-architecture.md#81-backend-application-structure)
    - [8.2 Entry Point & App Initialization](./8-backend-architecture.md#82-entry-point-app-initialization)
    - [8.3 Routing Layer (Hono Routes)](./8-backend-architecture.md#83-routing-layer-hono-routes)
    - [8.4 Middleware Layer](./8-backend-architecture.md#84-middleware-layer)
    - [8.5 Service Layer (Business Logic)](./8-backend-architecture.md#85-service-layer-business-logic)
    - [8.6 Repository Layer (Data Access)](./8-backend-architecture.md#86-repository-layer-data-access)
    - [8.7 Reputation Calculator Service](./8-backend-architecture.md#87-reputation-calculator-service)
      - [8.7.1 Reputation Utility Functions](./8-backend-architecture.md#871-reputation-utility-functions)
      - [8.7.2 Reputation Service Implementation](./8-backend-architecture.md#872-reputation-service-implementation)
    - [8.8 Provider Interfaces (External Integrations)](./8-backend-architecture.md#88-provider-interfaces-external-integrations)
    - [8.8 Background Jobs (Durable Objects)](./8-backend-architecture.md#88-background-jobs-durable-objects)
    - [8.9 Webhook Handling (Airtable Sync)](./8-backend-architecture.md#89-webhook-handling-airtable-sync)
    - [8.10 Error Handling & Custom Errors](./8-backend-architecture.md#810-error-handling-custom-errors)
    - [8.11 Utility Functions](./8-backend-architecture.md#811-utility-functions)
    - [8.12 Backend Testing Strategy](./8-backend-architecture.md#812-backend-testing-strategy)
    - [8.13 Performance Considerations](./8-backend-architecture.md#813-performance-considerations)
    - [8.14 Security Best Practices](./8-backend-architecture.md#814-security-best-practices)
    - [8.15 Deployment Configuration](./8-backend-architecture.md#815-deployment-configuration)
    - [8.7 Background Jobs & Cron Tasks](./8-backend-architecture.md#87-background-jobs-cron-tasks)
      - [8.7.1 Overview](./8-backend-architecture.md#871-overview)
      - [8.7.2 Job #1: Time Slot Generation](./8-backend-architecture.md#872-job-1-time-slot-generation)
      - [8.7.3 Job #2: Pending Booking Expiration](./8-backend-architecture.md#873-job-2-pending-booking-expiration)
      - [8.7.4 Job #3: Tier Override Auto-Rejection](./8-backend-architecture.md#874-job-3-tier-override-auto-rejection)
      - [8.7.5 Job #4: Dormant User Detection](./8-backend-architecture.md#875-job-4-dormant-user-detection)
      - [8.7.6 Cron Job Logging Table](./8-backend-architecture.md#876-cron-job-logging-table)
      - [8.7.7 Job Management & Monitoring](./8-backend-architecture.md#877-job-management-monitoring)
      - [8.7.8 Cron Job Summary Table](./8-backend-architecture.md#878-cron-job-summary-table)
  - [9. Unified Project Structure](./9-unified-project-structure.md)
    - [9.1 Complete Monorepo Structure](./9-unified-project-structure.md#91-complete-monorepo-structure)
    - [9.2 Root Package Configuration](./9-unified-project-structure.md#92-root-package-configuration)
    - [9.3 Workspace Package Configuration](./9-unified-project-structure.md#93-workspace-package-configuration)
    - [9.4 TypeScript Configuration](./9-unified-project-structure.md#94-typescript-configuration)
    - [9.5 ESLint Configuration](./9-unified-project-structure.md#95-eslint-configuration)
    - [9.6 Build Pipeline & Scripts](./9-unified-project-structure.md#96-build-pipeline-scripts)
    - [9.7 Development Workflow Commands](./9-unified-project-structure.md#97-development-workflow-commands)
    - [9.8 Environment Variables](./9-unified-project-structure.md#98-environment-variables)
    - [9.9 VS Code Configuration](./9-unified-project-structure.md#99-vs-code-configuration)
    - [9.10 Git Configuration](./9-unified-project-structure.md#910-git-configuration)
    - [9.11 Dependency Management Best Practices](./9-unified-project-structure.md#911-dependency-management-best-practices)
    - [9.12 Build Optimization](./9-unified-project-structure.md#912-build-optimization)
    - [9.13 Continuous Integration](./9-unified-project-structure.md#913-continuous-integration)
  - [10. Development Workflow](./10-development-workflow.md)
    - [10.1 Initial Development Setup](./10-development-workflow.md#101-initial-development-setup)
      - [10.1.0 Repository Initialization (First-Time Setup Only)](./10-development-workflow.md#1010-repository-initialization-first-time-setup-only)
      - [10.1.1 Regular Developer Setup](./10-development-workflow.md#1011-regular-developer-setup)
      - [10.1.6 Database Migrations](./10-development-workflow.md#1016-database-migrations)
    - [10.2 Local Development](./10-development-workflow.md#102-local-development)
    - [10.3 Testing Practices](./10-development-workflow.md#103-testing-practices)
    - [10.4 Debugging Strategies](./10-development-workflow.md#104-debugging-strategies)
    - [10.5 Code Quality & Standards](./10-development-workflow.md#105-code-quality-standards)
    - [10.6 Git Workflow](./10-development-workflow.md#106-git-workflow)
    - [10.7 Pull Request Process](./10-development-workflow.md#107-pull-request-process)
    - [10.8 Troubleshooting Common Issues](./10-development-workflow.md#108-troubleshooting-common-issues)
    - [10.9 Performance Profiling](./10-development-workflow.md#109-performance-profiling)
    - [10.10 Documentation Practices](./10-development-workflow.md#1010-documentation-practices)
    - [10.11 Collaboration Best Practices](./10-development-workflow.md#1011-collaboration-best-practices)
  - [11. Deployment Architecture](./11-deployment-architecture.md)
    - [11.1 Deployment Overview](./11-deployment-architecture.md#111-deployment-overview)
    - [11.2 Environment Strategy](./11-deployment-architecture.md#112-environment-strategy)
    - [11.3 Frontend Deployment (Cloudflare Pages)](./11-deployment-architecture.md#113-frontend-deployment-cloudflare-pages)
    - [11.4 Backend Deployment (Cloudflare Workers)](./11-deployment-architecture.md#114-backend-deployment-cloudflare-workers)
    - [11.5 Database Deployment (Supabase)](./11-deployment-architecture.md#115-database-deployment-supabase)
    - [11.6 CI/CD Pipeline](./11-deployment-architecture.md#116-cicd-pipeline)
    - [11.7 Monitoring & Health Checks](./11-deployment-architecture.md#117-monitoring-health-checks)
    - [11.8 Rollback Procedures](./11-deployment-architecture.md#118-rollback-procedures)
    - [11.10 Performance Optimization](./11-deployment-architecture.md#1110-performance-optimization)
    - [11.11 Security Hardening](./11-deployment-architecture.md#1111-security-hardening)
    - [11.12 Cost Management](./11-deployment-architecture.md#1112-cost-management)
    - [11.13 Deployment Checklist](./11-deployment-architecture.md#1113-deployment-checklist)
  - [12. Security and Performance](#12-security-and-performance)
  - [13. Testing Strategy](#13-testing-strategy)
  - [14. Coding Standards](#14-coding-standards)
  - [15. Error Handling Strategy](#15-error-handling-strategy)
  - [16. Monitoring and Observability](#16-monitoring-and-observability)
  - [Document Complete](#document-complete)
